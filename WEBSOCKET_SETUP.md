# Настройка WebSocket подключения

## Реализовано

✅ Реальное сетевое подключение через WebSocket
✅ Автоматическая синхронизация состояния игры с сервером
✅ Отправка команд (движение, установка бомбы, готовность)
✅ Обработка всех сообщений от сервера

## Настройка для тестирования

### Для iOS симулятора:
1. Перейдите в папку с сервером и запустите его:
   ```bash
   cd Bomberman
   source ../venv/bin/activate  # если виртуальное окружение не активировано
   python server/main.py
   ```
2. Запустите приложение в симуляторе
3. Подключение будет работать автоматически (используется `ws://localhost:8765`)

### Для реального iOS устройства:
1. Узнайте IP адрес вашего компьютера:
   - macOS: `ifconfig | grep "inet " | grep -v 127.0.0.1`
   - Windows: `ipconfig`
   - Linux: `hostname -I`

2. Откройте файл `Bomberman/Networking/GameClient.swift`

3. Найдите строку 38 и замените:
   ```swift
   return URL(string: "ws://localhost:8765")!
   ```
   на:
   ```swift
   return URL(string: "ws://ВАШ_IP_АДРЕС:8765")!
   ```
   Например: `return URL(string: "ws://192.168.1.100:8765")!`

4. Убедитесь, что компьютер и устройство находятся в одной Wi-Fi сети

5. Перейдите в папку с сервером и запустите его:
   ```bash
   cd Bomberman
   source ../venv/bin/activate  # если виртуальное окружение не активировано
   python server/main.py
   ```

6. Запустите приложение на устройстве

## Протокол обмена сообщениями

### Сообщения от клиента к серверу:
- `{"type": "join", "name": "Имя", "role": "player"|"spectator"}` - подключение
- `{"type": "ready"}` - переключение готовности
- `{"type": "move", "dx": -1|0|1, "dy": -1|0|1}` - движение
- `{"type": "place_bomb"}` - установка бомбы

### Сообщения от сервера к клиенту:
- `{"type": "assign_id", "payload": "client_id"}` - присвоение ID
- `{"type": "game_state", "payload": {...}}` - состояние игры (отправляется 60 раз в секунду)

## Структура game_state:
```json
{
  "state": "WAITING"|"IN_PROGRESS"|"GAME_OVER",
  "winner": "имя"|"НИЧЬЯ"|null,
  "time_remaining": число|null,
  "map": [["#", ".", " ", "p", ...], ...],
  "players": [{"id": "...", "name": "...", "x": 0, "y": 0, "alive": true, "ready": false}, ...],
  "bombs": [{"x": 0, "y": 0}, ...],
  "explosions": [{"x": 0, "y": 0}, ...]
}
```

## Символы карты:
- `#` - неразрушаемая стена
- `.` - разрушаемая стена
- ` ` - пустая клетка
- `p` - стартовая позиция игрока

## Что дальше?

Теперь нужно реализовать:
1. Рендеринг игрового поля (GameSceneView)
2. Управление персонажем (жесты/кнопки для движения и установки бомбы)
3. Отображение карты, бомб, взрывов и игроков

